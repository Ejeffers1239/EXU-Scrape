<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
	<head>
		<title>Custom Card</title>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="viewport" content="width=1024">
		<meta name="title" content="Duelingbook" />
		<meta name="description" content="Duelingbook is a Yu-Gi-Oh! Trading Card Game simulator that works right in your browser." />
		<meta name="keywords" content="yugioh" />
		<meta property="og:title" content="Custom Card" />
		<meta property="og:type" content="website" />
		<meta property="og:description" content="Duelingbook is a Yu-Gi-Oh! Trading Card Game simulator that works right in your browser." />
		<meta property="og:image" content="https://www.duelingbook.com//site_image.jpg" />
		<meta property="og:url" content="https://www.duelingbook.com" />
		<meta property="og:site_name" content="Duelingbook" />
		<link rel="stylesheet" type="text/css" href="static/main.css?v=336">
		<link rel="stylesheet" type="text/css" href="static/OverlayScrollbars.min.css">
		<script src="static/jquery.min.js"></script>
		<script src="static/jquery.overlayScrollbars.min.js"></script>
		<script src="static/snap.svg-min.js"></script>
		<script src="static/SnapSVGAnimator.min.js"></script>
		<script src="static/TweenMax.min.js"></script>
		<script src="static/watch.min.js"></script>
		<style>
		</style>
	</head>
	<body>
		<div id="black" style="background-color: black; width: 100%; height: 100%; z-index: 99;"></div>
		<div id="content" class="unselectable" style="display: none;">
			<img id="circuit_board" src="images/circuit_board_small.jpg" width="1024" height="724" alt="Background" />
			<div id="circuit_cover"></div>
			<div id="greenlines">
				<div id="greenlines1" >
					<img src="images/svg/greenlines.svg" alt="Green Lines" />
				</div>
				<div id="greenlines2" >
					<img src="images/svg/greenlines.svg" alt="Green Lines" />
				</div>
			</div>
			<!--<div id="dark"></div>-->
			<div id="my_card"></div>
			<div id="preview_txt" class="textarea" tabindex="0"></div>
			<div id="screenshot_btn">
				<div class="hidden"></div>
				<img src="images/svg/screenshot_btn_up.svg" alt="Screenshot" />
			</div>
			<div id="dim"></div>
			<div id="msg">
				<span class="title_txt">Message</span>
				<div class="body_txt selectable">Sample message<br>Sample message<br>Sample message</div>
				<div class="ok_btn">
					<img src="images/svg/ok_btn_up.svg" alt="OK" />
				</div>
			</div>
		</div>
		<div id="mes1"></div>
		<div id="mes2"></div>
		<div id="mes3"></div>
		<div id="mes4"></div>
		<script src="static/utils.js?v=336"></script>
		<script>
			var card_id = GET('id');
			var title = 'Custom Card';
			window.onload = loadedE;
			$('#image').hide();
			var my_card = new CardFront();
			my_card.css("transform", "scale(0.5253, 0.5301)");
			my_card.find('.name_txt').addClass("selectable");
			my_card.find('.passcode_txt').addClass("selectable");
			my_card.initialize();
			my_card.hide();
			my_card.find('.pic').css("pointer-events", "auto");
			my_card.find('.pic').css("cursor", "pointer");
			my_card.find('.pic').click(function(){
				window.open($(this).attr("src"));
			});
			$('#my_card').html(my_card);
			$('#my_card').css("cursor", "auto");
			preview_txt.off("mouseout");
			$('#screenshot_btn').off("click");
			$('#screenshot_btn').click(takeScreenshot);
			
			//card_id = 1052562;
			//card_id = 771766;
			//card_id = 1064597;
						
			function loadedE() {
				console.log('loading ' + card_id);
				initDB();
				if (window.innerHeight >= 640) {
					mes2.show();
					mes2.setHTML(skinny_ad);
				}
				var xhr = new XMLHttpRequest();
				xhr.open("GET", URL_START + "load-card.php?id=" + card_id, true);
				xhr.onreadystatechange = function() {
					if (xhr.readyState == 4 && xhr.status == 200) {
						loadCardComplete(xhr.responseText);
					}
				};
				xhr.send();
				showDim();
			}
			
			function loadCardComplete(str) {
				log(str);
				hideDim();
				var data = JSON.parse(str);
				if (data.action == "Error") {
					errorE(data.message);
					return;
				}
				my_card.show();
				my_card.initializeFromData(data);
				previewFront(my_card);
				maximizePreview();
				if (card_id < 20000) {
					title = 'Card';
				}
				document.title = title + ' - ' + my_card.data("name");
			}
			
			function takeScreenshot() {
				console.time("dom-to-image");
				var zoom = $('#content')[0].style.zoom;
				var defer = $.Deferred();
				var filtered = defer.then(function(value) {
					return domtoimage.toPng(my_card[0], {"bgcolor":"#000000", "width":813, "height":1185, "style":{"transform":"scale(1)", "margin":"0px", "zoom":"1"}});
				});
				defer.resolve();
				filtered.done(function(url) {
					console.timeEnd("dom-to-image");
					console.log(url);
					var fd = new FormData();
					fd.append("Filedata", url.substring(22, url.length));

					var xhr = new XMLHttpRequest();
					xhr.open("POST", URL_START + "php-scripts/card-screenshot.php?id=" + card_id, true);
					xhr.onreadystatechange = function() {
						if (xhr.readyState == 4 && xhr.status == 200) {
							window.open(xhr.responseText);
						}
					};
					xhr.send(fd);
				});
				filtered.fail(function(error) {
					messageE("Failed to create image");
				});
				playSound(SnapShot);
			}
		</script>
		<script src="static/dom-to-image.min.js" async></script>
	</body>
</html><script>showMes = 1; banner_ad = '<div class="banner-ad" align="center"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"><\/script><ins class="adsbygoogle" style="display: inline-block; width: 728px; height: 90px; pointer-events: auto;" data-ad-client="ca-pub-8917830655675593" data-ad-slot="2153284745"><\/ins><script>(adsbygoogle = window.adsbygoogle || []).push({});<\/script><\/div>'; skinny_ad = '<span class="skinny-ad" align="right"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"><\/script><ins class="adsbygoogle" style="display: inline-block; width: 160px; height: 600px; pointer-events: auto;" data-ad-client="ca-pub-8917830655675593" data-ad-slot="2898742749"><\/ins><script>(adsbygoogle = window.adsbygoogle || []).push({});<\/script><\/span>';</script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61656057-2', 'auto');
  ga('send', 'pageview');

</script>